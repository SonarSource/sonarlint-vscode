/* --------------------------------------------------------------------------------------------
 * SonarLint for VisualStudio Code
 * Copyright (C) 2017-2025 SonarSource SÃ rl
 * sonarlint@sonarsource.com
 * Licensed under the LGPLv3 License. See LICENSE.txt in the project root for license information.
 * ------------------------------------------------------------------------------------------ */
'use strict';

import { Diagnostic } from 'vscode-languageclient';
import { FindingNode } from './findingNode';
import { FindingSource, FindingType } from '../findingsTreeDataProviderUtil';

export class TaintVulnerabilityNode extends FindingNode {
  constructor(fileUri: string, finding: Diagnostic) {
    super(fileUri, FindingType.TaintVulnerability, finding, 'Taint Vulnerability');
    this.contextValue = this.isAiCodeFixable ? 'AICodeFixableTaintItem' : 'taintVulnerabilityItem';
    const serverName = this.source === FindingSource.Latest_SonarCloud ? 'SonarQube Cloud' : 'SonarQube Server';
    this.tooltip = `This Taint Vulnerability was detected by ${serverName}`;
  }
}
